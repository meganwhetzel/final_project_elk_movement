<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Database Structure and Creation | Analyzing Elk Movement Ecology Using GPS Collar Data</title>
  <meta name="description" content="This is my final project website." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Database Structure and Creation | Analyzing Elk Movement Ecology Using GPS Collar Data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is my final project website." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Database Structure and Creation | Analyzing Elk Movement Ecology Using GPS Collar Data" />
  
  <meta name="twitter:description" content="This is my final project website." />
  

<meta name="author" content="Megan Whetzel" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="chapter3.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Analyzing Elk Movement Ecology Using GPS Collar Data</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#project-goals"><i class="fa fa-check"></i><b>1.1</b> Project Goals</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#project-outline"><i class="fa fa-check"></i><b>1.2</b> Project Outline</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter2.html"><a href="chapter2.html"><i class="fa fa-check"></i><b>2</b> Database Structure and Creation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter2.html"><a href="chapter2.html#description-of-structure"><i class="fa fa-check"></i><b>2.1</b> Description of structure</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter2.html"><a href="chapter2.html#database-diagram"><i class="fa fa-check"></i><b>2.1.1</b> <strong>Database Diagram</strong></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter2.html"><a href="chapter2.html#building-the-database"><i class="fa fa-check"></i><b>2.2</b> Building the Database</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter3.html"><a href="chapter3.html"><i class="fa fa-check"></i><b>3</b> Temperature</a></li>
<li class="chapter" data-level="4" data-path="chapter4.html"><a href="chapter4.html"><i class="fa fa-check"></i><b>4</b> Elk Movement</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter4.html"><a href="chapter4.html#plotting-an-elks-path"><i class="fa fa-check"></i><b>4.1</b> Plotting an elkâ€™s path</a></li>
<li class="chapter" data-level="4.2" data-path="chapter4.html"><a href="chapter4.html#heatmap-of-elk-landscape-usage"><i class="fa fa-check"></i><b>4.2</b> Heatmap of elk landscape usage</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> Elk Usage of the Landscape</a></li>
<li class="chapter" data-level="6" data-path="chapter6.html"><a href="chapter6.html"><i class="fa fa-check"></i><b>6</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analyzing Elk Movement Ecology Using GPS Collar Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter2" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 2</span> Database Structure and Creation</h1>
<div id="description-of-structure" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Description of structure</h2>
<p>I structured my database (<em>see image below</em>) with only one table because
of the simplicity of the elk movement dataset. This GPS table contains all the
raw telemetry data from the elk and a few other variables that were collected.</p>
<div id="database-diagram" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> <strong>Database Diagram</strong></h3>
<div class="figure" style="text-align: center"><span id="fig:figure"></span>
<img src="database_structure.png" alt="Image of simple database structure (single table) of elk movement" width="364" />
<p class="caption">
Figure 2.1: Image of simple database structure (single table) of elk movement
</p>
</div>
</div>
</div>
<div id="building-the-database" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Building the Database</h2>
<p>First, to build the database using RSQLite, I will install the packages necessary for analyzing the data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="chapter2.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;DBI&quot;</span>)</span>
<span id="cb1-2"><a href="chapter2.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb1-3"><a href="chapter2.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;lubridate&quot;</span>)</span>
<span id="cb1-4"><a href="chapter2.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;ggmap&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="chapter2.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb2-2"><a href="chapter2.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## â”€â”€ Attaching packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 1.3.1 â”€â”€</code></pre>
<pre><code>## âœ“ ggplot2 3.3.3     âœ“ purrr   0.3.4
## âœ“ tibble  3.1.1     âœ“ dplyr   1.0.5
## âœ“ tidyr   1.1.3     âœ“ stringr 1.4.0
## âœ“ readr   1.4.0     âœ“ forcats 0.5.1</code></pre>
<pre><code>## â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="chapter2.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     date, intersect, setdiff, union</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="chapter2.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmap)</span></code></pre></div>
<pre><code>## Google&#39;s Terms of Service: https://cloud.google.com/maps-platform/terms/.</code></pre>
<pre><code>## Please cite ggmap if you use it! See citation(&quot;ggmap&quot;) for details.</code></pre>
<p>Next, I will need to connect to the created database (already in SQLite).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="chapter2.html#cb12-1" aria-hidden="true" tabindex="-1"></a>elk_db <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), <span class="st">&quot;/Users/Megan/Desktop/Rep_Sci/Elk_Movement_Project/elk_movement.db&quot;</span>)</span></code></pre></div>
<p>I am able to create queries by using the R syntax code below:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="chapter2.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExecute</span>(elk_movement_db, <span class="st">&quot;CREATE TABLE elk_gps_data (</span></span>
<span id="cb13-2"><a href="chapter2.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="st">elk_id varchar(4) NOT NULL,</span></span>
<span id="cb13-3"><a href="chapter2.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="st">tag_id varchar(7) NOT NULL,</span></span>
<span id="cb13-4"><a href="chapter2.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="st">longitude double,</span></span>
<span id="cb13-5"><a href="chapter2.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="st">latitude double,</span></span>
<span id="cb13-6"><a href="chapter2.html#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="st">timestamp double,</span></span>
<span id="cb13-7"><a href="chapter2.html#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="st">temp_c float,</span></span>
<span id="cb13-8"><a href="chapter2.html#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="st">height_above_ellipsoid_m float,</span></span>
<span id="cb13-9"><a href="chapter2.html#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="st">PRIMARY KEY (tag_id)</span></span>
<span id="cb13-10"><a href="chapter2.html#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="st">);&quot;</span>)</span></code></pre></div>
<p><strong>However, the table is also already created within my database through SQL</strong></p>
<p>I can link to the query and pull in the table:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="chapter2.html#cb14-1" aria-hidden="true" tabindex="-1"></a>gps <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(elk_db, <span class="st">&quot;SELECT * FROM elk_gps_data;&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in result_fetch(res@ptr, n = n): Column `longitude`: mixed type, first
## seen values of type string, coercing other values of type real</code></pre>
<pre><code>## Warning in result_fetch(res@ptr, n = n): Column `latitude`: mixed type, first
## seen values of type string, coercing other values of type real</code></pre>
<pre><code>## Warning in result_fetch(res@ptr, n = n): Column `temp_c`: mixed type, first seen
## values of type string, coercing other values of type real</code></pre>
<pre><code>## Warning in result_fetch(res@ptr, n = n): Column `height_above_ellipsoid_m`:
## mixed type, first seen values of type string, coercing other values of type real</code></pre>
<p>I can look at the structure of my data to check that it is indeed a data frame
and see what the top few rows look like:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="chapter2.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(gps)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="chapter2.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gps)</span></code></pre></div>
<pre><code>##   elk_id tag_id    longitude   latitude timestamp temp_c
## 1 elk_id tag_id    longitude   latitude timestamp temp_c
## 2    856   E001 -114.2984652 49.5031774   00:24.0  -15.0
## 3    856   E001 -114.2951732 49.5039912   00:41.0  -14.0
## 4    856   E001 -114.2944663  49.504332   00:47.0  -14.0
## 5    856   E001  -114.295414 49.5082298   00:48.0  -14.0
## 6    856   E001 -114.2954858  49.508393   00:48.0  -13.0
##   height_above_ellipsoid_m
## 1 height_above_ellipsoid_m
## 2                  1404.02
## 3                  1425.33
## 4                  1479.75
## 5                  1525.02
## 6                  1539.76</code></pre>
<p>It looks like the top row is a repeat of column headers, so I can remove that.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="chapter2.html#cb23-1" aria-hidden="true" tabindex="-1"></a>gps <span class="ot">&lt;-</span> gps[<span class="sc">-</span><span class="dv">1</span>, ]</span></code></pre></div>
<p>Finally, I will need to convert most of the columns into numeric since they were
pulled into R as character:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="chapter2.html#cb24-1" aria-hidden="true" tabindex="-1"></a>gps<span class="sc">$</span>height_above_ellipsoid_m <span class="ot">=</span> <span class="fu">as.numeric</span>(gps<span class="sc">$</span>height_above_ellipsoid_m)</span>
<span id="cb24-2"><a href="chapter2.html#cb24-2" aria-hidden="true" tabindex="-1"></a>gps<span class="sc">$</span>longitude <span class="ot">=</span> <span class="fu">as.numeric</span>(gps<span class="sc">$</span>longitude)</span>
<span id="cb24-3"><a href="chapter2.html#cb24-3" aria-hidden="true" tabindex="-1"></a>gps<span class="sc">$</span>latitude <span class="ot">=</span> <span class="fu">as.numeric</span>(gps<span class="sc">$</span>latitude)</span>
<span id="cb24-4"><a href="chapter2.html#cb24-4" aria-hidden="true" tabindex="-1"></a>gps<span class="sc">$</span>temp_c <span class="ot">=</span> <span class="fu">as.numeric</span>(gps<span class="sc">$</span>temp_c)</span></code></pre></div>
<p>Now, I can look at the actual number of individuals collared. It looks like we
have about 98 elk in the dataset so multiple collars (tags) were put on the same
elk in some instances.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="chapter2.html#cb25-1" aria-hidden="true" tabindex="-1"></a>gps <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="chapter2.html#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(elk_id) <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="chapter2.html#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="chapter2.html#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##       elk_id
## 2        856
## 11247    849
## 23338    844
## 34305    862
## 53539    846
## 69368    872</code></pre>
<p>And 170 tags.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="chapter2.html#cb27-1" aria-hidden="true" tabindex="-1"></a>gps <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="chapter2.html#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(tag_id) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="chapter2.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb27-4"><a href="chapter2.html#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##       tag_id
## 2       E001
## 11247   E002
## 14804   E093
## 17675   E138
## 21468   E172
## 23338   E003</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Rep_Sci Final Project.pdf", "Rep_Sci Final Project.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
