[["index.html", "Analyzing Elk Movement Ecology Using GPS Collar Data Chapter 1 Introduction 1.1 Project Goals 1.2 Project Outline", " Analyzing Elk Movement Ecology Using GPS Collar Data Megan Whetzel 4/30/2021 Chapter 1 Introduction My project will be looking at elk (Cervus elaphus) GPS collar data collected in southwestern Alberta, Canada. This particular study looked at elk behavior and compared it to their movement. I was able to download this data from MoveBank (a website for publicly available data) and will use this dataset as a surrogate for data I collect in the coming two years while completing my Master’s degree. I will be analyzing ungulate (elk, deer (Odocoileus spp), and livestock) movement through and usage of wildfire-burned areas so this telemetry data was very useful for practicing my analysis skills. I plan to use the elk ID to ensure points are matched to each individual elk and their corresponding location data. This is captured in latitude/longitude. These points have a timestamp as well as the ambient temperature and elevation captured as the height above the ellipsoid recorded at the time of the location being taken. I will focus on using the telemetry locations and other covariates to plot elk movement and answer questions about their ecology captured from the collars. 1.1 Project Goals I will answer these few questions: How does ambient temperature change across the study site and what temperatures did elk have to withstand in Southwestern Alberta? How are elk using the landscape individually and in relation to other collared elk? And, to expand upon the first question: Which locations are elk using more frequently? 1.2 Project Outline This book contains the following chapters: Chapter 2: Database Structure and Creation Chapter 3: Temperature Chapter 4: Elk Movement Chapter 5: Elk Usage of the Landscape Chapter 6: References "],["chapter2.html", "Chapter 2 Database Structure and Creation 2.1 Description of structure 2.2 Building the Database", " Chapter 2 Database Structure and Creation 2.1 Description of structure I structured my database (see image below) with only one table because of the simplicity of the elk movement dataset. This GPS table contains all the raw telemetry data from the elk and a few other variables that were collected. 2.1.1 Database Diagram Figure 2.1: Image of simple database structure (single table) of elk movement 2.2 Building the Database First, to build the database using RSQLite, I will install the packages necessary for analyzing the data. install.packages(&quot;DBI&quot;) install.packages(&quot;tidyverse&quot;) install.packages(&quot;lubridate&quot;) install.packages(&quot;ggmap&quot;) library(DBI) library(tidyverse) ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ── ## ✓ ggplot2 3.3.3 ✓ purrr 0.3.4 ## ✓ tibble 3.1.1 ✓ dplyr 1.0.5 ## ✓ tidyr 1.1.3 ✓ stringr 1.4.0 ## ✓ readr 1.4.0 ✓ forcats 0.5.1 ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ── ## x dplyr::filter() masks stats::filter() ## x dplyr::lag() masks stats::lag() library(lubridate) ## ## Attaching package: &#39;lubridate&#39; ## The following objects are masked from &#39;package:base&#39;: ## ## date, intersect, setdiff, union library(ggmap) ## Google&#39;s Terms of Service: https://cloud.google.com/maps-platform/terms/. ## Please cite ggmap if you use it! See citation(&quot;ggmap&quot;) for details. Next, I will need to connect to the created database (already in SQLite). elk_db &lt;- dbConnect(RSQLite::SQLite(), &quot;/Users/Megan/Desktop/Rep_Sci/Elk_Movement_Project/elk_movement.db&quot;) I am able to create queries by using the R syntax code below: dbExecute(elk_movement_db, &quot;CREATE TABLE elk_gps_data ( elk_id varchar(4) NOT NULL, tag_id varchar(7) NOT NULL, longitude double, latitude double, timestamp double, temp_c float, height_above_ellipsoid_m float, PRIMARY KEY (tag_id) );&quot;) However, the table is also already created within my database through SQL I can link to the query and pull in the table: gps &lt;- dbGetQuery(elk_db, &quot;SELECT * FROM elk_gps_data;&quot;) ## Warning in result_fetch(res@ptr, n = n): Column `longitude`: mixed type, first ## seen values of type string, coercing other values of type real ## Warning in result_fetch(res@ptr, n = n): Column `latitude`: mixed type, first ## seen values of type string, coercing other values of type real ## Warning in result_fetch(res@ptr, n = n): Column `temp_c`: mixed type, first seen ## values of type string, coercing other values of type real ## Warning in result_fetch(res@ptr, n = n): Column `height_above_ellipsoid_m`: ## mixed type, first seen values of type string, coercing other values of type real I can look at the structure of my data to check that it is indeed a data frame and see what the top few rows look like: class(gps) ## [1] &quot;data.frame&quot; head(gps) ## elk_id tag_id longitude latitude timestamp temp_c ## 1 elk_id tag_id longitude latitude timestamp temp_c ## 2 856 E001 -114.2984652 49.5031774 00:24.0 -15.0 ## 3 856 E001 -114.2951732 49.5039912 00:41.0 -14.0 ## 4 856 E001 -114.2944663 49.504332 00:47.0 -14.0 ## 5 856 E001 -114.295414 49.5082298 00:48.0 -14.0 ## 6 856 E001 -114.2954858 49.508393 00:48.0 -13.0 ## height_above_ellipsoid_m ## 1 height_above_ellipsoid_m ## 2 1404.02 ## 3 1425.33 ## 4 1479.75 ## 5 1525.02 ## 6 1539.76 It looks like the top row is a repeat of column headers, so I can remove that. gps &lt;- gps[-1, ] Finally, I will need to convert most of the columns into numeric since they were pulled into R as character: gps$height_above_ellipsoid_m = as.numeric(gps$height_above_ellipsoid_m) gps$longitude = as.numeric(gps$longitude) gps$latitude = as.numeric(gps$latitude) gps$temp_c = as.numeric(gps$temp_c) Now, I can look at the actual number of individuals collared. It looks like we have about 98 elk in the dataset so multiple collars (tags) were put on the same elk in some instances. gps %&gt;% select(elk_id) %&gt;% unique() %&gt;% head() ## elk_id ## 2 856 ## 11247 849 ## 23338 844 ## 34305 862 ## 53539 846 ## 69368 872 And 170 tags. gps %&gt;% select(tag_id) %&gt;% unique() %&gt;% head() ## tag_id ## 2 E001 ## 11247 E002 ## 14804 E093 ## 17675 E138 ## 21468 E172 ## 23338 E003 "],["chapter3.html", "Chapter 3 Temperature", " Chapter 3 Temperature I was interested in looking at the distribution of temperatures across the study site, especially since it took place in southwestern Alberta and northern Montana; places where I would assume the weather is fairly mild in the summer and cold in the winter. I selected one elk, 1590, from the dataset to look at the ambient temperatures it experienced over the course of its location points. I plotted it to show the range of temperatures an elk has to live through on a yearly basis. gps %&gt;% select(temp_c, elk_id) %&gt;% filter(elk_id == &quot;1590&quot;) %&gt;% ggplot(aes(x = temp_c, fill = elk_id)) + geom_bar(fill = &quot;salmon1&quot;) + labs(x = &quot;Temperature (Cº)&quot;, y = &quot;Count&quot;, fill = &quot;Elk ID&quot;) + theme_minimal() + theme(legend.position = &quot;none&quot;) Then, I used the data from the same elk to create another plot with the frequency for each temperature. gps %&gt;% select(temp_c, elk_id) %&gt;% filter(elk_id == &quot;1590&quot;) %&gt;% ggplot(aes(x = temp_c, fill = elk_id)) + geom_bar(aes(y = ..prop.., group = 1), fill = &quot;springgreen3&quot;) + labs(x = &quot;Temperature (Cº)&quot;, y = &quot;Relative frequency&quot;, fill = &quot;Elk ID&quot;) + theme_minimal() + theme(legend.position = &quot;none&quot;) Luckily, the most frequent temperatures for the elk were between -3ºC to 12ºC or about 26ºF to 54ºF. I assumed temperatures would fluctuate largely due to seasonal changes but I was surprised to see the wide range of temperatures that elk lived through on the study site. It looks like the elk experienced anywhere from -28ºC to around 30ºC! Finally, I took 8 other elk in addition to elk 1590 and plotted the temperatures they experienced. gps %&gt;% select(temp_c, elk_id) %&gt;% filter(elk_id %in% c(&quot;1590&quot;, &quot;786&quot;, &quot;297&quot;, &quot;609374A&quot;, &quot;395&quot;, &quot;609372A&quot;, &quot;858&quot;, &quot;843&quot;, &quot;172&quot;)) %&gt;% ggplot(aes(x = elk_id, y = temp_c, color = elk_id)) + geom_boxplot() + labs(y = &quot;Temperature (Cº)&quot;, x = &quot;Elk ID&quot;, color = &quot;Elk ID&quot;) + theme_minimal() + theme(legend.position = &quot;none&quot;) Overall, it looks like elk experience a range of 0ºC to 10ºC on average with some high and low outliers! Because of the temperature extremes I noticed while plotting the previous graphs, I created a new plot to show every elk and the maximum and minimum temperatures recorded for each. I removed the 26 elk that had missing temperature data. gps %&gt;% group_by(elk_id) %&gt;% mutate(max_temp = max(temp_c)) %&gt;% mutate(min_temp = min(temp_c)) %&gt;% filter(!is.na(max_temp)) %&gt;% distinct(elk_id, max_temp, min_temp, temp_c) %&gt;% ggplot(aes(x = elk_id)) + geom_boxplot(aes(y = max_temp, color = &quot;darkred&quot;)) + geom_boxplot(aes(y = min_temp, color = &quot;royalblue3&quot;)) + labs(x = &quot;Elk ID&quot;, y = &quot;Temperature (Cº)&quot;, color = &quot;Elk ID&quot;) + theme_classic() + theme(axis.text.x = element_text(angle = 90)) + theme(legend.position = &quot;none&quot;) The plot is a little overwhelming and doesn’t tell us too much, but it is still interesting to see the temperature extremes (high and low) throughout the seasons in Alberta. "],["chapter4.html", "Chapter 4 Elk Movement 4.1 Plotting an elk’s path 4.2 Heatmap of elk landscape usage", " Chapter 4 Elk Movement I had a large number of elk to work with so I wanted to plot the coordinates of a subset of them to compare their movement in relation to each other and the study area. Generally, elk travel many kilometers for seasonal migration and as part of their home range - seasonally they can average about 100 km! I aimed to see how elk are moving individually and whether their paths cross with other elk while moving through their home ranges. 4.1 Plotting an elk’s path I isolated one elk, number 878, and plotted its telemetry points: gps %&gt;% filter(elk_id == &quot;878&quot;) %&gt;% ggplot(aes(x = longitude, y = latitude, color = elk_id)) + geom_path(color = &quot;turquoise&quot;) + labs(x = &quot;Longitude&quot;, y = &quot;Latitude&quot;) + theme_minimal() + theme(legend.position = &quot;none&quot;) Most elk appeared to have interesting patterns of movement so I plotted a few more individually to see how they looked: Elk 1622: gps %&gt;% filter(elk_id == &quot;1622&quot;) %&gt;% ggplot(aes(x = longitude, y = latitude, color = elk_id)) + geom_path(color = &quot;slateblue&quot;) + labs(x = &quot;Longitude&quot;, y = &quot;Latitude&quot;) + theme_minimal() + theme(legend.position = &quot;none&quot;) Elk 300: gps %&gt;% filter(elk_id == &quot;300&quot;) %&gt;% ggplot(aes(x = longitude, y = latitude, color = elk_id)) + geom_path(color = &quot;palevioletred&quot;) + labs(x = &quot;Longitude&quot;, y = &quot;Latitude&quot;) + theme_minimal() + theme(legend.position = &quot;none&quot;) Then, I chose 6 more elk to compare the movements of with elk 878, 1622, and 300: gps %&gt;% filter(elk_id %in% c(&quot;1622&quot;, &quot;878&quot;, &quot;300&quot;, &quot;611&quot;, &quot;609380B&quot;, &quot;32439&quot;, &quot;179&quot;, &quot;1996&quot;, &quot;609377A&quot;)) %&gt;% ggplot(aes(x = longitude, y = latitude, color = elk_id)) + geom_path() + labs(x = &quot;Longitude&quot;, y = &quot;Latitude&quot;, color = &quot;Elk ID&quot;) + facet_wrap(~ elk_id) + scale_color_viridis_d(option = &quot;rocket&quot;) + theme_minimal() + theme(legend.position = &quot;bottom&quot;) + theme(axis.text.x = element_text(angle = 90)) Just simply looking at these paths created by the telemetry points doesn’t really tell us much about the elk’s decisions. What locations did they use the most? 4.2 Heatmap of elk landscape usage I created a heat map of a few elk to really see where on the landscape elk were spending the most time. Elk 878: gps %&gt;% select(elk_id, longitude, latitude) %&gt;% filter(elk_id == &quot;878&quot;) %&gt;% ggplot(aes(x = longitude, y = latitude, )) + geom_hex() + scale_fill_viridis_c(option = &quot;inferno&quot;) + labs(x = &quot;Longitude&quot;, y = &quot;Latitude&quot;, title = &quot;Heatmap of Most Used Locations for Elk 878&quot;) + theme_minimal() + theme(legend.position = &quot;right&quot;) Elk 1622: gps %&gt;% select(elk_id, longitude, latitude) %&gt;% filter(elk_id == &quot;1622&quot;) %&gt;% ggplot(aes(x = longitude, y = latitude, )) + geom_hex() + scale_fill_viridis_c(option = &quot;inferno&quot;) + labs(x = &quot;Longitude&quot;, y = &quot;Latitude&quot;, title = &quot;Heatmap of Most Used Locations for Elk 1622&quot;) + theme_minimal() + theme(legend.position = &quot;right&quot;) And again, elk 300: gps %&gt;% select(elk_id, longitude, latitude) %&gt;% filter(elk_id == &quot;300&quot;) %&gt;% ggplot(aes(x = longitude, y = latitude)) + geom_hex() + labs(x = &quot;Longitude&quot;, y = &quot;Latitude&quot;, title = &quot;Heatmap of Most Used Locations for Elk 300&quot;) + scale_fill_viridis_c(option = &quot;inferno&quot;) + theme_minimal() + theme(legend.position = &quot;right&quot;) It seems as if elk 300 enjoyed 2 different areas within its home range and also traveled quickly between those 2 locations. Here are the heatmaps of the other 6 elk: gps %&gt;% filter(elk_id %in% c(&quot;611&quot;, &quot;609380B&quot;, &quot;32439&quot;, &quot;179&quot;, &quot;1996&quot;, &quot;609377A&quot;)) %&gt;% ggplot(aes(x = longitude, y = latitude)) + geom_hex() + scale_fill_viridis_c(option = &quot;inferno&quot;) + labs(x = &quot;Longitude&quot;, y = &quot;Latitude&quot;) + facet_wrap(~ elk_id) + theme_minimal() + theme(legend.position = &quot;bottom&quot;) + theme(axis.text.x = element_text(angle = 90)) Elk do appear to be utilizing different locations on the landscape than each other. However, this dataset would have been more useful if it also contained sex of the elk. I would have liked to compare male to female elk in terms of movement and size of home ranges because of differences in seasonal migration, caring for young, and utilizing resources. "],["chapter5.html", "Chapter 5 Elk Usage of the Landscape", " Chapter 5 Elk Usage of the Landscape In the previous chapter, I showed graphically how elk were moving individually and in relation to each other. The graphs I made were interesting, but they didn’t really show the whole picture. I decided to do a deep dive into the world of ggmap. Ggmap allows you to bring in a Google Map image of an area of interest and overlay data points on top of it. I thought this would be super useful in helping me visualize how these elk were moving on the landscape. I needed to get an API key to register myself to use ggmap, which was a headache all on its own! I am keeping it hidden because it is a unique identifier for me. First, I set up a google map by using the coordinates given for the study area in Movebank: elk_map &lt;- get_googlemap(center = c(-114.400, 49.400)) ## Source : https://maps.googleapis.com/maps/api/staticmap?center=49.4,-114.4&amp;zoom=10&amp;size=640x640&amp;scale=2&amp;maptype=terrain&amp;key=xxx Then, I successfully pulled in a map of the study area, without data points: ggmap(elk_map, extent = &quot;normal&quot;) There is the general area of the elk study! Next, I subset some data to be able to plot points on this map: solo_elk &lt;- gps %&gt;% filter(elk_id == &quot;878&quot;) facet &lt;- gps %&gt;% filter(elk_id %in% c(&quot;1622&quot;, &quot;878&quot;, &quot;300&quot;, &quot;611&quot;, &quot;609380B&quot;, &quot;32439&quot;, &quot;179&quot;, &quot;1996&quot;, &quot;609377A&quot;)) And finally, I can plot elk 878 with some actual context: qmplot(longitude, latitude, data = solo_elk, color = elk_id, geom = &quot;path&quot;, legend = &quot;right&quot;) + labs(color = &quot;Elk ID&quot;) ## Using zoom = 11... ## Source : http://tile.stamen.com/terrain/11/371/698.png ## Source : http://tile.stamen.com/terrain/11/372/698.png ## Source : http://tile.stamen.com/terrain/11/373/698.png ## Source : http://tile.stamen.com/terrain/11/374/698.png ## Source : http://tile.stamen.com/terrain/11/371/699.png ## Source : http://tile.stamen.com/terrain/11/372/699.png ## Source : http://tile.stamen.com/terrain/11/373/699.png ## Source : http://tile.stamen.com/terrain/11/374/699.png ## Source : http://tile.stamen.com/terrain/11/371/700.png ## Source : http://tile.stamen.com/terrain/11/372/700.png ## Source : http://tile.stamen.com/terrain/11/373/700.png ## Source : http://tile.stamen.com/terrain/11/374/700.png ## Source : http://tile.stamen.com/terrain/11/371/701.png ## Source : http://tile.stamen.com/terrain/11/372/701.png ## Source : http://tile.stamen.com/terrain/11/373/701.png ## Source : http://tile.stamen.com/terrain/11/374/701.png ## Source : http://tile.stamen.com/terrain/11/371/702.png ## Source : http://tile.stamen.com/terrain/11/372/702.png ## Source : http://tile.stamen.com/terrain/11/373/702.png ## Source : http://tile.stamen.com/terrain/11/374/702.png Now elk 878’s movements make a lot more sense. It stuck mostly to valley bottoms and spent some time in the upper right hand corner where more roads and civilization appear to be. And finally, a plot of the 9 elk used in the previous facet wrap: qmplot(longitude, latitude, data = facet, color = elk_id, geom = &quot;path&quot;, legend = &quot;topright&quot;, zoom = 10) + scale_color_viridis_d(option = &quot;turbo&quot;) + labs(color = &quot;Elk ID&quot;) ## Source : http://tile.stamen.com/terrain/10/185/348.png ## Source : http://tile.stamen.com/terrain/10/186/348.png ## Source : http://tile.stamen.com/terrain/10/187/348.png ## Source : http://tile.stamen.com/terrain/10/188/348.png ## Source : http://tile.stamen.com/terrain/10/189/348.png ## Source : http://tile.stamen.com/terrain/10/185/349.png ## Source : http://tile.stamen.com/terrain/10/186/349.png ## Source : http://tile.stamen.com/terrain/10/187/349.png ## Source : http://tile.stamen.com/terrain/10/188/349.png ## Source : http://tile.stamen.com/terrain/10/189/349.png ## Source : http://tile.stamen.com/terrain/10/185/350.png ## Source : http://tile.stamen.com/terrain/10/186/350.png ## Source : http://tile.stamen.com/terrain/10/187/350.png ## Source : http://tile.stamen.com/terrain/10/188/350.png ## Source : http://tile.stamen.com/terrain/10/189/350.png ## Source : http://tile.stamen.com/terrain/10/185/351.png ## Source : http://tile.stamen.com/terrain/10/186/351.png ## Source : http://tile.stamen.com/terrain/10/187/351.png ## Source : http://tile.stamen.com/terrain/10/188/351.png ## Source : http://tile.stamen.com/terrain/10/189/351.png ## Source : http://tile.stamen.com/terrain/10/185/352.png ## Source : http://tile.stamen.com/terrain/10/186/352.png ## Source : http://tile.stamen.com/terrain/10/187/352.png ## Source : http://tile.stamen.com/terrain/10/188/352.png ## Source : http://tile.stamen.com/terrain/10/189/352.png It looks like the elk actually did have overlapping home ranges and many stayed in similar areas. Elk 300 was isolated from the others and even crossed over the border into Montana. I was incredibly excited to be able to get ggmap to work properly and to produce a very cool map showing elk movement. It looks like movement varies widely individually and many elk actually have home range overlaps. This would generally be expected because they are a herd species and in the rut, males keep harems of females, so more elk would be in the same places. I would probably have a better understanding of how the elk move if all 98 were plotted on this map, but to avoid too much confusion, I’ll stick with the nine currently plotted! "],["chapter6.html", "Chapter 6 References", " Chapter 6 References ggmap: D. Kahle and H. Wickham. ggmap: Spatial Visualization with ggplot2. The R Journal, 5(1), 144-161. URL http://journal.r-project.org/archive/2013-1/kahle-wickham.pdf Movebank: Original article: Ciuti S, Muhly TB, Paton DG, McDevitt AD, Musiani M, Boyce MS (2012) Human selection of elk behavioural traits in a landscape of fear. Proceedings of the Royal Society B 279(1746): 4407-4416. doi:10.1098/rspb.2012.1483 Movebank data package: Boyce MS, Ciuti S (2020) Data from: Human selection of elk behavioural traits in a landscape of fear. Movebank Data Repository. doi:10.5441/001/1.j484vk24 "]]
